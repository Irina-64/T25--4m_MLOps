# ü•ä UFC Fight Predictor

**UFC Fight Predictor** ‚Äî —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ –∫—É—Ä—Å—É MLOps.  
–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–æ–≤ –±–æ—ë–≤ UFC –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.  

---

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–î–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –ø–æ–µ–¥–∏–Ω–∫–æ–≤ UFC: –±–æ–π—Ü–æ–≤, —Å–æ–±—ã—Ç–∏—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É–¥–∞—Ä–æ–≤ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.  
–ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è:
- –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –±–æ—è;
- –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–æ–π—Ü–æ–≤ –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ;
- –ø–æ–∏—Å–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –ø–æ–±–µ–¥—ã.

---

### –ó–∞–ø—É—Å–∫

docker build -t ufc-fight-predictor .

docker run -p 8080:8080 ufc-fight-predictor

### MLOps-–ø–∞–π–ø–ª–∞–π–Ω –≤ Apache Airflow


–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –º–æ–¥–µ–ª–∏ UFC-–ø—Ä–æ–≥–Ω–æ–∑–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å –ø–æ–º–æ—â—å—é Apache Airflow –∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –≤ Docker.
–ü–∞–π–ø–ª–∞–π–Ω –≤–∫–ª—é—á–∞–µ—Ç —ç—Ç–∞–ø—ã:
preprocess ‚Üí train ‚Üí evaluate ‚Üí register_alias
–ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º Airflow-—Ç–∞—Å–∫–æ–º.
–í –∫–æ–Ω—Ü–µ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ MLflow Model Registry, –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è alias staging.
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é Airflow: cd airflow

# –ó–∞–ø—É—Å–∫
docker compose down
docker compose up --build -d

http://localhost:8080 –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å : admin
1.	–û—Ç–∫—Ä—ã—Ç—å DAG ufc_ml_pipeline
2.	–ù–∞–∂–∞—Ç—å Trigger DAG

### üìå–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—ã–π —à–∞–≥ –ø–∞–π–ø–ª–∞–π–Ω–∞
1. Preprocess - –û—á–∏—â–∞–µ—Ç –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ: üìÑ data/raw/ ‚Üí üìÑ data/processed/processed.csv
2. Train - –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ models/model.joblib
3. Evaluate - —Ä–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤ –≤ reports/eval.json, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ MLflow, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏
4. Alias - –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –º–æ–¥–µ–ª–∏, –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –µ–π alias staging


### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ø–æ—è–≤–ª—è—é—Çc—è:
üìå data/processed/processed.csv
üìå models/model.joblib
üìå reports/eval.json
üìå –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ –≤ MLflow
üìå alias staging –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏

‚úÖ –í—Å–µ —Ç–∞—Å–∫–∏ –≤ Airflow –∑–µ–ª—ë–Ω—ã–µ.

### ‚ö° Feature Store (Feast)
1. –ö–∞—Ç–∞–ª–æ–≥: feature_repo/
2.	Entity: fight_id, –ø—Ä–∏–∑–Ω–∞–∫–∏: fighter_stats, recent_wins, fight_history, win_ratio
3.	–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ —Ñ–∏—á–∞—Ö –∏–∑ offline store Feast
4.	–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è:
cd feature_repo
feast apply
feast materialize 2020-01-01 2025-12-31

## ‚ò∏Ô∏è –î–µ–ø–ª–æ–π –≤ Kubernetes (Minikube)

–î–µ–ø–ª–æ–π API –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä (Minikube). –û–±—Ä–∞–∑ —Å–æ–±–∏—Ä–∞–µ–º –ø—Ä—è–º–æ –≤ Docker –≤–Ω—É—Ç—Ä–∏ Minikube, —á—Ç–æ–±—ã –Ω–µ –ø—É—à–∏—Ç—å –≤ Registry.

### –®–∞–≥–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä –∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å Docker –Ω–∞ Minikube:
   ```bash
   minikube start
   minikube addons enable metrics-server   # –Ω—É–∂–Ω–æ –¥–ª—è HPA
   eval $(minikube docker-env)
   ```
2. –°–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `Dockerfile`; –º–æ–¥–µ–ª—å —É–∂–µ –ª–µ–∂–∏—Ç –≤ `model_store/` –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–∑–∞):
   ```bash
   docker build -t ufc-pred .
   ```
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã:
   ```bash
   kubectl apply -f k8s/
   kubectl get pods,svc
   ```
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞:
   ```bash
   curl -X POST http://127.0.0.1:65272/predict \
   -H "Content-Type: application/json" \
   -d '{"carrier":"AA","dep_hour":9,"distance":500}'
   ```
5. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:
   ```bash
   # –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
   kubectl scale --replicas=3 deployment/ufc-api
   # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ CPU (–ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏)
   kubectl get hpa
   ```

–ú–∞–Ω–∏—Ñ–µ—Å—Ç—ã –≤ `k8s/`: Deployment —Å –æ–±—Ä–∞–∑–æ–º `ufc-pred`, Service `ufc-api-svc` (NodePort 30080), HPA `ufc-pred-hpa` —Å –ø–æ—Ä–æ–≥–æ–º 50% CPU. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–∏—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å –∏–∑ `/app/models/model.joblib` (–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –æ–±—Ä–∞–∑ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ).

## üìä Monitoring (Prometheus + Grafana)

API –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `prometheus_client` –∏ –æ—Ç–¥–∞—ë—Ç `/metrics`. –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: `–°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–±–µ–¥—ã`, `P95 latency`, `Requests / second`.

## üíØ CI/CD –¥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞

–ì–æ—Ç–æ–≤ GitHub Actions workflow `.github/workflows/deploy.yml`: –Ω–∞ push –≤ `main` –ø—Ä–æ–≥–æ–Ω—è–µ—Ç —Ç–µ—Å—Ç—ã, —Å–æ–±–∏—Ä–∞–µ—Ç Docker-–æ–±—Ä–∞–∑, –ø—É—à–∏—Ç –≤ GHCR –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ–±—Ä–∞–∑ –≤ Kubernetes.

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
- `KUBE_CONFIG_DATA` ‚Äî base64 –æ—Ç kubeconfig —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –∫–ª–∞—Å—Ç–µ—Ä—É (—Å–æ–∑–¥–∞–π—Ç–µ `cat ~/.kube/config | base64 -w0`).
- Registry –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `GITHUB_TOKEN` (`packages: write`), –ø–æ—ç—Ç–æ–º—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–ª—è GHCR –Ω–µ –Ω—É–∂–Ω–æ. –°–¥–µ–ª–∞–π—Ç–µ –ø–∞–∫–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–º –æ–¥–∏–Ω —Ä–∞–∑ —á–µ—Ä–µ–∑ UI GHCR –∏–ª–∏ `imagePullSecret`, —á—Ç–æ–±—ã –∫–ª–∞—Å—Ç–µ—Ä –º–æ–≥ —Ç—è–Ω—É—Ç—å –æ–±—Ä–∞–∑.

–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ pipeline:
1. `pytest -q`
2. `docker build -t ghcr.io/<owner>/ufc-api:{sha|latest} .`
3. `docker push` –æ–±–æ–∏—Ö —Ç–µ–≥–æ–≤ –≤ GHCR
4. `kubectl set image deployment/ufc-api ufc-api=ghcr.io/<owner>/ufc-api:latest && kubectl rollout status`

–ü—Ä–æ–≤–µ—Ä–∫–∞: –ø—É—à—å—Ç–µ –≤ feature-–≤–µ—Ç–∫—É ‚Üí PR ‚Üí merge –≤ `main`; –≤ –ª–æ–≥–∞—Ö Actions —É–≤–∏–¥–∏—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—é –æ–±—Ä–∞–∑–∞ –∏ —É—Å–ø–µ—à–Ω—ã–π rollout –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞ `ufc-api`.

### üéì  Docker Compose (API + Prometheus + Grafana)

1. –ü–æ–¥–Ω—è—Ç—å —Å—Ç–µ–∫:  
   `docker compose -f docker-compose.yaml up --build -d`  
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ API/–º–µ—Ç—Ä–∏–∫: `curl http://localhost:8080/health`, `curl http://localhost:8080/metrics | head`.
3. Prometheus UI: http://localhost:9090 ‚Äî —Ç–∞—Ä–≥–µ—Ç `ufc-api` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `UP`;
4. Grafana UI: http://localhost:3000 (admin/admin). Datasource –∏ –¥–∞—à–±–æ—Ä–¥ –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `grafana/provisioning/`.


### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```
docker compose -f docker-compose.yaml down -v
```






